import pandas as pd
from brownie import *

controllers = {
    "wsteth": Contract("0x100daa78fc509db39ef7d04de0c1abd299f4c6ce"),
    "wbtc": Contract("0x4e59541306910ad6dc1dac0ac9dfb29bd9f15c67"),
    "sfrxeth": Contract("0x8472a9a7632b173c8cf3a86d3afec50c35548e76"),
    "weth": Contract("0xa920de414ea4ab66b97da1bfe9e6eca7d4219635"),
}


def main():
    prices = []
    for t in load_times():
        print(t)
        price_row = [t]
        for k, v in controllers.items():
            try:
                price = v.n_loans(block_identifier=t)
            except:
                price = None
            price_row.append(price)
        prices.append(price_row)

    # Creating the DataFrame with appropriate column names
    columns = ["Time"] + list(controllers.keys())
    price_df = pd.DataFrame(prices, columns=columns)

    # Saving to CSV
    price_df.to_csv("scripts/data/nloans.csv", index=False)
    print("Data saved to 'nloans.csv'.")


def load_times():
    return [
        17432225,
        17437586,
        17442947,
        17448308,
        17453669,
        17459030,
        17464391,
        17469753,
        17475114,
        17480475,
        17485836,
        17491197,
        17496558,
        17501920,
        17507281,
        17512642,
        17518003,
        17523364,
        17528725,
        17534087,
        17539448,
        17544809,
        17550170,
        17555531,
        17560892,
        17566254,
        17571615,
        17576976,
        17582337,
        17587698,
        17593059,
        17598421,
        17603782,
        17609143,
        17614504,
        17619865,
        17625226,
        17630587,
        17635949,
        17641310,
        17646671,
        17652032,
        17657393,
        17662754,
        17668116,
        17673477,
        17678838,
        17684199,
        17689560,
        17694921,
        17700283,
        17705644,
        17711005,
        17716366,
        17721727,
        17727088,
        17732450,
        17737811,
        17743172,
        17748533,
        17753894,
        17759255,
        17764617,
        17769978,
        17775339,
        17780700,
        17786061,
        17791422,
        17796783,
        17802145,
        17807506,
        17812867,
        17818228,
        17823589,
        17828950,
        17834312,
        17839673,
        17845034,
        17850395,
        17855756,
        17861117,
        17866479,
        17871840,
        17877201,
        17882562,
        17887923,
        17893284,
        17898646,
        17904007,
        17909368,
        17914729,
        17920090,
        17925451,
        17930813,
        17936174,
        17941535,
        17946896,
        17952257,
        17957618,
        17437633,
        17443041,
        17448450,
        17453858,
        17459266,
        17464675,
        17470083,
        17475491,
        17480900,
        17486308,
        17491716,
        17497125,
        17502533,
        17507941,
        17513350,
        17518758,
        17524167,
        17529575,
        17534983,
        17540392,
        17545800,
        17551208,
        17556617,
        17562025,
        17567433,
        17572842,
        17578250,
        17583658,
        17589067,
        17594475,
        17599883,
        17605292,
        17610700,
        17616109,
        17621517,
        17626925,
        17632334,
        17637742,
        17643150,
        17648559,
        17653967,
        17659375,
        17664784,
        17670192,
        17675600,
        17681009,
        17686417,
        17691825,
        17697234,
        17702642,
        17708051,
        17713459,
        17718867,
        17724276,
        17729684,
        17735092,
        17740501,
        17745909,
        17751317,
        17756726,
        17762134,
        17767542,
        17772951,
        17778359,
        17783767,
        17789176,
        17794584,
        17799993,
        17805401,
        17810809,
        17816218,
        17821626,
        17827034,
        17832443,
        17437628,
        17443031,
        17448435,
        17453838,
        17459242,
        17464645,
        17470049,
        17475452,
        17480856,
        17486259,
        17491662,
        17497066,
        17502469,
        17507873,
        17513276,
        17518680,
        17524083,
        17529487,
        17534890,
        17540293,
        17545697,
        17551100,
        17556504,
        17561907,
        17567311,
        17572714,
        17578118,
        17583521,
        17588924,
        17594328,
        17599731,
        17605135,
        17610538,
        17615942,
        17621345,
        17626749,
        17632152,
        17637555,
        17642959,
        17648362,
        17653766,
        17659169,
        17664573,
        17669976,
        17675380,
        17680783,
        17686186,
        17691590,
        17696993,
        17702397,
        17707800,
        17713204,
        17718607,
        17724011,
        17729414,
        17734817,
        17740221,
        17745624,
        17751028,
        17756431,
        17761835,
        17767238,
        17772642,
        17778045,
        17783448,
        17788852,
        17794255,
        17799659,
        17805062,
        17810466,
        17815869,
        17821273,
        17826676,
        17832079,
        17837483,
        17842886,
        17848290,
        17853693,
        17859097,
        17864500,
        17869904,
        17875307,
        17880710,
        17886114,
        17891517,
        17896921,
        17902324,
        17907728,
        17913131,
        17918535,
        17923938,
        17929341,
        17934745,
        17940148,
        17945552,
        17950955,
        17956359,
        17961762,
        17967166,
        17437615,
        17443006,
        17448397,
        17453788,
        17459179,
        17464570,
        17469961,
        17475352,
        17480743,
        17486134,
        17491525,
        17496916,
        17502307,
        17507698,
        17513089,
        17518480,
        17523871,
        17529262,
        17534653,
        17540043,
        17545434,
        17550825,
        17556216,
        17561607,
        17566998,
        17572389,
        17577780,
        17583171,
        17588562,
        17593953,
        17599344,
        17604735,
        17610126,
        17615517,
        17620908,
        17626299,
        17631690,
        17637081,
        17642472,
        17647862,
        17653253,
        17658644,
        17664035,
        17669426,
        17674817,
        17680208,
        17685599,
        17690990,
        17696381,
        17701772,
        17707163,
        17712554,
        17717945,
        17723336,
        17728727,
        17734118,
        17739509,
        17744900,
        17750291,
        17755681,
        17761072,
        17766463,
        17771854,
        17777245,
        17782636,
        17788027,
        17793418,
        17798809,
        17804200,
        17809591,
        17814982,
        17820373,
        17825764,
        17831155,
        17836546,
    ]
